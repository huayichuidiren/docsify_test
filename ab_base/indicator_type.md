# 如何定义一个指标

## 一、原子指标、复合指标、派生指标

从**计算方式**上看，指标可以分为原子指标、复合指标。原子指标就是计算方式单一的指标、复合指标就是计算方式复杂的指标。

1. 原子指标：基于**单一算子**来计算的数值型指标。其中，基于单一算子来运算，说明原子指标具有「不可拆分性」。**按统计的是时间或时点来区分**，原子指标又可以分为两种：「事实型指标」和「存量型指标」。事实型指标具有特点：基于一段时间来统计，比如“一周内购买量”。此外，事实型指标还具有单一业务含义，它只用于描述单一的业务上事实（比如用户购买、用户注册），在这一点上，事实型指标可以简单理解为「动作+度量」。存量型指标则基于一个时点来统计，比如“6月6日在装app用户数”。

   如果你学过「宏观经济学」，你应该了解“流量”和“存量”的区别。其实「事实型指标」和「存量型指标」正好分别对应“流量”和“存量”的概念。事实型指标是基于一个时间段统计的、具有单一业务含义的指标；存量型指标是基于时间点统计的、用于刻画给定当前状态的指标。

   为了理解这一点，我们可以分别举几个「原子指标-事实型指标」和「原子指标-存量型指标」的例子：

   1. 事实型指标1: 近一周 用户购买 量（近一周是想看的时间段、用户购买是动作、量是度量）
   2. 事实型指标2: 近一周 用户注册 量（近一周是想看的时间段、用户注册是动作、量是度量）
   3. 存量型指标1: 6月6日在架商品总数（6月6日是想看的时间点、指标用于刻画在架商品数量）
   4. 存量型指标2: 6月6日在装app用户数（6月6日是想看的时间点、指标用于刻画在装app数量）

   以上4个指标的SQL计算逻辑是什么呢？

   ```sql
   -- 事务性指标
   select count(distinct purchase_id)-- 根据用户购买id统计，我们只用了count(distinct )一个算子
   from 增量表
   where date between 当前日期-6 and 当前日期
   
   -- 存量型指标
   select count(distinct goods_id)-- 根据在架商品id统计，也只用了count(distinct )一个算子
   from 全量表 -- 在架商品的全量表
   where date = 最新日期那个分区
   ```

   你可以发现，无论事务型指标还是存量型指标，均只用了一个算子。**基于单一算子来计算**的数值型指标就是原子指标。

2. 复合指标

   复合指标有很多种类型：统计量型（包括均值型、比例型、比率型、分位数型）、变化量/变化率型、排名型（按某个规则排名的名次）。

从**前后缀的使用**上看，我们把使用前后缀的指标称为**派生指标**。举个例子，“用户购买量”是原子指标，但“近7天PC端用户购买量”就是派生指标，因为我们加入了前缀“近7天PC端”。当然在一些语境中，我们也把“近7天PC端用户购买量”当作原子指标，但此时我们用词是有偏差的，我们的本意是更关注该指标计算的**原子性**。派生指标也称为衍生指标。

## 二、AB实验中经常提到的三种指标

上面的原子指标和复合指标是依据计算复杂性来定义的，衍生指标是依据是否使用前后缀来定义的。在AB实验中，我们有自己的指标分类，实际我们尤其关注这三种指标：均值指标、比例指标、比率指标。这是因为在AB实验中，有「分流单元」和「分析单元」的概念。按用户分流的实验，分流单元就是用户；但如果我们在「用户分流」的实验中，想分析“点击率”这个指标，那么我们的分析单元是**每次点击**。均值指标和比率指标正是按照「分析单元」的差异来区分的。他们分别有着如下的计算规则：
$$
均值指标=\dfrac{1}{n}\sum_{i=1}^{n}X_i\\
比例指标=\dfrac{1}{n}\sum_{i=1}^{n}B_i\\
比率指标=\dfrac{\sum_{i=1}^{n}X_i}{\sum_{i=1}^{n}Y_i}\\
$$
